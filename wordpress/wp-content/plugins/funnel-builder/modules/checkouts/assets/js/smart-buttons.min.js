!function(t){new class{constructor(){this.smart_button_id="#wfacp_smart_buttons",this.loading_gif="wfacp-dynamic-checkout-loading",this.button_displayed=!1,this.available_buttons={},this.wcEvents()}wcEvents(){"loading"!==document.readyState?this.DOMLoaded():document.addEventListener("DOMContentLoaded",()=>{this.DOMLoaded()})}isMobilePhone(){return"yes"===wfacp_frontend.is_mobile_phone}DOMLoaded(){t(document.body).on("updated_checkout",this.handleCheckout.bind(this)),t(document.body).on("fkwcs_smart_buttons_showed",this.handleWfgsGateway.bind(this)),t(document.body).on("fkwcs_generate_smart_buttons",this.handleCheckout.bind(this)),this.checkButtons()}updateWrapperClass(){let e=Object.keys(this.available_buttons).length;e>0&&t(".wfacp_smart_button_outer_buttons").attr("count",e)}handleCheckout(){this.handleAmazonShadowButton(),this.updateWrapperClass(),this.show_hide_smart_button()}handleWfgsGateway(){let e=t("#wfacp_smart_button_fkwcs_gpay_apay");if(0===e.length)return;e.show(),this.showButton("#wfacp_smart_button_fkwcs_gpay_apay"),this.showButtons();let o=t(".fkwcs_stripe_smart_button_wrapper");1===t(".wfacp_smart_button_container").length&&1===o.length&&!1===o.is(":visible")&&this.hideButtons()}show_hide_smart_button(){let e=200;"yes"===wfacp_frontend.is_desktop&&"yes"===wfacp_frontend.stripe_smart_show_on_desktop?e=wfacp_frontend.smart_button_hide_timeout:"no"===wfacp_frontend.is_desktop&&(e=wfacp_frontend.smart_button_hide_timeout_m),1==this.button_displayed&&(e=this.isMobilePhone()?500:100),setTimeout(()=>{if(!0===this.button_displayed){let e=t(".fkwcs_stripe_smart_button_wrapper");1===t(".wfacp_smart_button_container").length&&1===e.length&&!1===e.is(":visible")?this.hideButtons():this.showButtons()}else this.hideButtons()},e)}getAvailableButtons(){return wfacp_frontend.smart_button_wrappers.dynamic_buttons}noConflictButton(){return wfacp_frontend.smart_button_wrappers.no_conflict_buttons}checkButtons(){let t=this.noConflictButton();for(let e=0;e<t.length;e++)this.findButtonElements(t[e]);let e=this.getAvailableButtons();for(let t in e){let o=e[t];this.domInsert(o,t)}}findButtonElements(t){null!=document.querySelector(t)&&(this.showButton(t),this.showButtonOnMobile())}domInsert(t,e){let o=document.querySelector(e);null!=o&&(window.MutationObserver?new MutationObserver(e=>{for(let o of e)"childList"===o.type&&(this.showButton(t),this.showButtonOnMobile())}).observe(o,{childList:!0,subtree:!0}):o.addEventListener("DOMNodeInserted",()=>{this.showButton(t),this.showButtonOnMobile()}))}showButtonOnMobile(){this.isMobilePhone()&&this.showButtons()}showButton(t){let e=document.querySelector(t);null!=e&&(this.available_buttons[t]="yes",e.style.display="block",this.updateWrapperClass(),this.button_displayed=!0)}showButtons(){let t=document.querySelector(this.smart_button_id);null!=t&&(t.style.display="block",t.classList.remove(this.loading_gif),this.button_displayed=!0,this.handleAmazonButton(t))}handleAmazonButton(){null!=document.querySelector("#pay_with_amazon .amazonpay-button-inner-image")&&document.querySelector("#pay_with_amazon").classList.add("wfacp-amazon-active-image")}handleAmazonShadowButton(){let e=null;t(".wfacp_smart_button_container .wc-amazon-payments-advanced-populated").length>0&&(e=t("#wfacp_smart_buttons")).addClass("wfacp_amazon_blocked"),setTimeout(()=>{let o=document.getElementById("pay_with_amazon");null!==o&&("object"==typeof o.shadowRoot&&null!==o.shadowRoot&&(o.shadowRoot.innerHTML="",t("#pay_with_amazon").css("opacity","1")),this.findButtonElements("#wfacp_smart_button_amazon_pay #pay_with_amazon"),e.removeClass("wfacp_amazon_blocked"))},500)}hideButtons(){let t=document.querySelector(this.smart_button_id);null!=t&&(t.style.display="none",this.button_displayed=!1)}}}(jQuery);