"use strict";function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var i=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,i?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(r){var o=function(){function t(e){_classCallCheck(this,t),null!=e&&(this.event_data=[],this.track_name=this.getTrackName(),this.track_id=e.id,this.settings=e.settings,this.data=e.data,this.maybe_fired="",this.init(),this.attach_triggers())}return _createClass(t,[{key:"getTrackName",value:function(){return""}},{key:"init",value:function(){}},{key:"attach_triggers",value:function(){var e=this;"complete"===document.readyState||"loading"===document.readyState?r(document).ready(function(){try{e.triggers()}catch(e){console.log(e)}}):r(window).on("load",function(){try{e.triggers()}catch(e){console.log(e)}})}},{key:"add_to_cart_event",value:function(){var n=this;r(document.body).on("added_to_cart",function(e,t){try{"object"==_typeof(t)&&t.hasOwnProperty("wffnTracking")&&(wffnTracking.pending_events=t.wffnTracking.pending_events,n.pending_events(!0))}catch(e){console.log(e)}})}},{key:"triggers",value:function(){this.add_to_cart_event();var e,t=this;"1"==t.settings.page_view&&t.load(),r("#wffn_late_event").length?(e=JSON.parse(r("#wffn_late_event").attr("dir")),Array.isArray(e)?e.forEach(function(e){setTimeout(function(){self.maybe_fired="",wffnTracking.pending_events=e,t.pending_events(),void 0!==t.fire_data&&t.fire_data()},200)}):(wffnTracking.pending_events=e,t.pending_events())):t.pending_events(),""!==t.track_name&&wffnTracking[t.track_name].hasOwnProperty("content_data")&&"1"==t.settings.view_content&&t.event_single_product_view_content(wffnTracking[t.track_name].content_data),void 0!==t.fire_data&&t.fire_data()}},{key:"pending_events",value:function(e){var t=this;if(wffnTracking.pending_events.hasOwnProperty(t.track_name))for(var n in wffnTracking.pending_events[t.track_name]){var i="";""!==(i=void 0!==wffnTracking.pending_events[t.track_name][n].event_id?wffnTracking.pending_events[t.track_name][n].event_id:i)&&t.maybe_fired===i||(t.maybe_fired=i,t.handle_pending(wffnTracking.pending_events[t.track_name][n].event,wffnTracking.pending_events[t.track_name][n].data,i))}!0===e&&void 0!==t.fire_data&&t.fire_data()}},{key:"load",value:function(){}},{key:"event_single_product_view_content",value:function(e){}},{key:"handle_pending",value:function(e,t,n){}}],[{key:"enqueue_js",value:function(){}}]),t}(),S=function(){_inherits(i,o);var a,n=_createSuper(i);function i(e,t){return _classCallCheck(this,i),(e=n.call(this,e)).track_name="pixel",e.eventCount=t,e}function e(e,t,n,i){return a.apply(this,arguments)}return _createClass(i,[{key:"getTrackName",value:function(){return"pixel"}},{key:"fire_data",value:function(){var e;0===this.eventCount&&void 0!==this.event_data&&0!==this.event_data.length&&(wffnTracking.is_ajax_mode?r.ajax({type:"POST",url:wffnTracking.ajax_endpoint,data:{action:"wffn_tracking_events",is_sitewide:!0,events:this.event_data},success:function(){this.event_data=[]},dataType:"application/json"}):(e={events:this.event_data,is_sitewide:!0},fetch(window.wffnTracking.restUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"wffn_tracking_events",data:e})})),this.event_data=[])}},{key:"send_data",value:function(e,t,n,i){this.event_data.push({event:e,data:t,event_id:n}),!0===i&&this.fire_data()}},{key:"handle_pending",value:function(e,t,n){this.fbq(e,t,n,!1)}},{key:"fbq",value:(a=function(e,t,n,i){n=void 0===n?this.get_event_id():n,t="undefined"!=typeof wffnAddTrafficParamsToEvent?wffnAddTrafficParamsToEvent(t):t,1==wffnTracking.pixel.conversion_api&&this.send_data(e,t,n,i),fbq("trackSingle",this.track_id,e,t,{eventID:n})},e.toString=function(){return a.toString()},e)},{key:"init",value:function(){wffnTracking.pixel.hasOwnProperty("fb_advanced")&&0!==wffnTracking.pixel.fb_advanced.length?fbq("init",this.track_id,wffnTracking.pixel.fb_advanced):fbq("init",this.track_id)}},{key:"load",value:function(){this.fbq("PageView",{},void 0,!1)}},{key:"event_single_product_view_content",value:function(e){this.fbq("ViewContent",this.maybeDateTime(e),void 0,!1)}},{key:"get_event_id",value:function(){var e=(new Date).getTime();return parseInt(e/1e3)}},{key:"maybeDateTime",value:function(e){var t=new Date;return t.event_time=["00-01","01-02","02-03","03-04","04-05","05-06","06-07","07-08","08-09","09-10","10-11","11-12","12-13","13-14","14-15","15-16","16-17","17-18","18-19","19-20","20-21","21-22","22-23","23-24"][t.getHours()],t.event_day=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()],t.event_month=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],e}}],[{key:"enqueue_js",value:function(){var e,t,n;t=window,n=document,t.fbq||(e=t.fbq=function(){e.callMethod?e.callMethod.apply(e,arguments):e.queue.push(arguments)},t._fbq||(t._fbq=e),(e.push=e).loaded=!0,e.version="2.0",e.queue=[],(t=n.createElement("script")).defer=!0,t.src="https://connect.facebook.net/en_US/fbevents.js",(n=n.getElementsByTagName("script")[0]).parentNode.insertBefore(t,n))}}]),i}(),C=function(){_inherits(n,o);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),(e=t.call(this,e)).track_name="ga",window.dataLayer=window.dataLayer||[],e.gtag("config",e.track_id,{}),e}return _createClass(n,[{key:"getTrackName",value:function(){return"ga"}},{key:"load",value:function(){"gad"===this.track_name&&"undefined"!==this.settings.page_view&&"1"===this.settings.page_view&&this.gtag("event","page_view",{send_to:this.track_id})}},{key:"gtag",value:function(){dataLayer.push(arguments)}},{key:"handle_pending",value:function(e,t,n){t="undefined"!=typeof wffnAddTrafficParamsToEvent?wffnAddTrafficParamsToEvent(t):t,"add_to_cart"===e&&void 0!==this.idlabel&&""!==this.idlabel&&"gad"===this.track_name&&"add_to_cart"===e?(t.send_to=this.idlabel,t.non_interaction=!0):t.send_to=this.track_id,this.gtag("event",e,t)}},{key:"event_single_product_view_content",value:function(e){var t;e.hasOwnProperty("view_item")&&(t=e.view_item,t="undefined"!=typeof wffnAddTrafficParamsToEvent?wffnAddTrafficParamsToEvent(t):t,e.view_item.send_to=this.track_id,e.view_item.non_interaction=!0,this.gtag("event","view_item",e.view_item))}}],[{key:"enqueue_js",value:function(e){var t,n;window,t=document,n="//www.googletagmanager.com/gtag/js?id="+e,e=t.createElement("script"),t=t.getElementsByTagName("script")[0],e.defer=1,e.src=n,t.parentNode.insertBefore(e,t),window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){dataLayer.push(arguments)},gtag("js",new Date)}}]),n}(),j=function(){_inherits(i,C);var n=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=n.call(this,e)).track_name="gad",t.idlabel=void 0!==e.idlabel?e.idlabel:"",window.dataLayer=window.dataLayer||[],t}return _createClass(i,[{key:"getTrackName",value:function(){return"gad"}}]),i}(),N=function(){_inherits(n,o);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),(e=t.call(this,e)).track_name="pint",e}return _createClass(n,[{key:"getTrackName",value:function(){return"pint"}},{key:"init",value:function(e){this.track_id.split(",").forEach(function(e){pintrk("load",e)})}},{key:"load",value:function(){pintrk("page")}},{key:"handle_pending",value:function(e,t,n){this.pint(e,t)}},{key:"pint",value:function(e,t){window.pintrk&&(t="undefined"!=typeof wffnAddTrafficParamsToEvent?wffnAddTrafficParamsToEvent(t):t,pintrk("track",e,t))}},{key:"event_single_product_view_content",value:function(e){this.pint("PageVisit",e)}}],[{key:"enqueue_js",value:function(){var e,t;window.pintrk||(window.pintrk=function(){window.pintrk.queue.push(Array.prototype.slice.call(arguments))},(t=window.pintrk).queue=[],t.version="3.0",(e=document.createElement("script")).defer=!0,e.src="https://s.pinimg.com/ct/core.js",(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t))}}]),n}(),E=function(){_inherits(i,o);var n,t=_createSuper(i);function i(e){return _classCallCheck(this,i),(e=t.call(this,e)).track_name="tiktok",e}function e(e,t){return n.apply(this,arguments)}return _createClass(i,[{key:"getTrackName",value:function(){return"tiktok"}},{key:"init",value:function(){"object"===("undefined"==typeof ttq?"undefined":_typeof(ttq))&&(ttq.load(this.track_id),wffnTracking.tiktok.hasOwnProperty("advanced")&&0!==wffnTracking.tiktok.advanced.length&&ttq.instance(this.track_id).identify(wffnTracking.tiktok.advanced))}},{key:"load",value:function(){ttq.page()}},{key:"ttq",value:(n=function(e,t){var n;"object"===("undefined"==typeof ttq?"undefined":_typeof(ttq))&&(n=this,setTimeout(function(){ttq.instance(n.track_id).track(e,t)},1200))},e.toString=function(){return n.toString()},e)},{key:"handle_pending",value:function(e,t,n){this.ttq(e,t)}},{key:"event_single_product_view_content",value:function(e){e.content_id=e.post_id,e.content_type="product",delete e.user_role,delete e.event_url,delete e.category_name,delete e.content_ids,delete e.product_price,delete e.post_id,delete e.landing_page,delete e.traffic_source,delete e.contents,this.ttq("ViewContent",e)}}],[{key:"enqueue_js",value:function(){!function(e,i){e.TiktokAnalyticsObject=i;var a=e.ttq=e.ttq||[];a.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],a.setAndDefer=function(e,t){e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}};for(var t=0;t<a.methods.length;t++)a.setAndDefer(a,a.methods[t]);a.instance=function(e){for(var t=a._i[e]||[],n=0;n<a.methods.length;n++)a.setAndDefer(t,a.methods[n]);return t},a.load=function(e,t){var n="https://analytics.tiktok.com/i18n/pixel/events.js";a._i=a._i||{},a._i[e]=[],a._i[e]._u=n,a._t=a._t||{},a._t[e]=+new Date,a._o=a._o||{},a._o[e]=t||{};t=document.createElement("script");t.type="text/javascript",t.defer=!0,t.src=n+"?sdkid="+e+"&lib="+i;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}}(window,(document,"ttq"))}}]),i}(),A=function(){_inherits(i,o);var n,t=_createSuper(i);function i(e){return _classCallCheck(this,i),(e=t.call(this,e)).track_name="snapchat",e}function e(e,t){return n.apply(this,arguments)}return _createClass(i,[{key:"getTrackName",value:function(){return"snapchat"}},{key:"init",value:function(){"function"==typeof snaptr&&snaptr("init",this.track_id,{integration:"woocommerce",user_email:this.settings.user_email})}},{key:"load",value:function(){this.snaptr("PAGE_VIEW",{})}},{key:"snaptr",value:(n=function(e,t){"function"==typeof snaptr&&(t="undefined"!=typeof wffnAddTrafficParamsToEvent?wffnAddTrafficParamsToEvent(t):t,snaptr("track",e,t))},e.toString=function(){return n.toString()},e)},{key:"handle_pending",value:function(e,t,n){this.snaptr(e,t)}}],[{key:"enqueue_js",value:function(){var e,t,n;e=window,t=document,e.snaptr||((n=e.snaptr=function(){n.handleRequest?n.handleRequest.apply(n,arguments):n.queue.push(arguments)}).queue=[],(e=t.createElement("script")).defer=!0,e.src="https://sc-static.net/scevent.min.js",(t=t.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t))}}]),i}(),e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"init",value:function(){var e=this;wffnTracking.hasOwnProperty("is_delay")&&0!==wffnTracking.is_delay?setTimeout(function(){e.fire_events()},wffnTracking.is_delay):e.fire_events()}},{key:"fire_events",value:function(){var e={},t=!1;if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("pixel")&&wffnTracking.pixel.hasOwnProperty("id")&&""!==wffnTracking.pixel.id){S.enqueue_js();var n=wffnTracking.pixel.id.split(",");if(0<n.length){e.facebook={};for(var i=0;i<n.length;i++){var a=n[i],r=JSON.stringify(wffnTracking.pixel);(r=JSON.parse(r)).id=a.trim(),e.facebook[a]=new S(r,i)}}}if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("ga")&&wffnTracking.ga.hasOwnProperty("id")&&""!==wffnTracking.ga.id){var o=wffnTracking.ga.id.split(",");if(0<o.length){t||(C.enqueue_js(o[0]),t=!0),e.ga={};for(var c=0;c<o.length;c++){var f=o[c],s=JSON.stringify(wffnTracking.ga);(s=JSON.parse(s)).id=f.trim(),e.ga[f]=new C(s)}}}if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("gad")&&wffnTracking.gad.hasOwnProperty("id")&&""!==wffnTracking.gad.id){var u=wffnTracking.gad.id.split(","),d=[];if("string"==typeof wffnTracking.gad.labels&&(d=wffnTracking.gad.labels.split(",")),0<u.length){t||(C.enqueue_js(u[0]),t=!0),e.gad={};for(var l=0;l<u.length;l++){var _=u[l],p=JSON.stringify(wffnTracking.gad);(p=JSON.parse(p)).id=_.trim(),void 0!==d[l]&&""!==d[l]&&(p.idlabel=p.id+"/"+d[l].trim()),e.gad[_]=new j(p)}}}if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("pint")&&wffnTracking.pint.hasOwnProperty("id")&&""!==wffnTracking.pint.id){var g=wffnTracking.pint.id.split(",");if(0<g.length){N.enqueue_js(),e.pint={};for(var v=0;v<g.length;v++){var k=g[v],h=JSON.stringify(wffnTracking.pint);(h=JSON.parse(h)).id=k.trim(),e.pint[k]=new N(h)}}}if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("tiktok")&&wffnTracking.tiktok.hasOwnProperty("id")&&""!==wffnTracking.tiktok.id){var y=wffnTracking.tiktok.id.split(",");if(0<y.length){E.enqueue_js(),e.tiktok={};for(var w=0;w<y.length;w++){var m=y[w],T=JSON.stringify(wffnTracking.tiktok);(T=JSON.parse(T)).id=m.trim(),e.tiktok[m]=new E(T)}}}if(1==wffnTracking.should_render&&wffnTracking.hasOwnProperty("snapchat")&&wffnTracking.snapchat.hasOwnProperty("id")&&""!==wffnTracking.snapchat.id){var b=wffnTracking.snapchat.id.split(",");if(0<b.length){A.enqueue_js(),e.snapchat={};for(var O=0;O<b.length;O++){var P=b[O],q=JSON.stringify(wffnTracking.snapchat);(q=JSON.parse(q)).id=P.trim(),e.snapchat[P]=new A(q)}}}}}]),e}();try{e.init()}catch(e){console.log(e)}}(jQuery);